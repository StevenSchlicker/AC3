\section{Optimization} \label{S:10.7.Optimization}

\vspace*{-14 pt}
\framebox{\hspace*{3 pt}
\parbox{6.25 in}{\begin{goals}
\item How can we find the points at which $f(x,y)$ has a local maximum
  or minimum?
\item How can we determine whether critical points of $f(x,y)$ are
  local maxima or minima? 
\item How can we find the absolute maximum and minimum of $f(x,y)$ on
  a closed and bounded domain?
\end{goals}} \hspace*{3 pt}}

\subsection*{Introduction}

We learn in single-variable calculus that the derivative is a useful tool for finding the local maxima
  and minima of functions, and that these ideas may often be employed in applied settings.  In particular, if a function $f$,
  such as the one shown in Figure \ref{F:10.7.preview.1} is everywhere
  differentiable, we know that the tangent line is horizontal at any point
  where $f$ has a local maximum or minimum.  This, of course, means that the derivative $f'$ is zero at any such point.  Hence, one way that we seek extreme values of a given function is to first find where the derivative of the function is zero.

    \begin{figure}[ht]
      \begin{center}
        \includegraphics{figures/fig_10_7_preview_1.eps}
      \end{center}	
      \caption{The graph of $y=f(x)$.}
      \label{F:10.7.preview.1}
    \end{figure}

  In multivariable calculus, we are often similarly interested in finding the greatest and/or least value(s) that a function may achieve.  Moreover, there are many applied settings in which a quantity of interest depends on several different variables.    In the following preview activity, we begin to see how some key ideas in multivariable calculus can help us answer such questions by thinking about the geometry of the surface generated by a function of two variables.

%We assume the maximal revenue will occur when the manufacturer sells all of the products. So if we let $f$ be the revenue obtained by selling $q_1$ items of good one at price $p_1$ per item and $q_2$ items of good two at price $p_2$ per item, then
%\[f(p_1, p_2, q_1, q_2) = p_1q_1 + p_2q_2.\]
%We can reduce the revenue to a function of just two variables $p_1$ and $p_2$ by using (\ref{eq:good1}) and (\ref{eq:good2}), giving us


\input{previews/10.7.PA2}

\subsection*{Extrema and Critical Points}

One of the important applications of single-variable calculus is the use of derivatives to identify local extremes of functions (that is, local maxima and local minima).  Using the tools we have developed so far, we can naturally extend
the concept of local maxima and minima to several-variable functions.

\vspace*{5pt}
\nin \framebox{\hspace*{3 pt}
  \parbox{6.25 in}{ \begin{definition}  Let $f$ be a function of two variables $x$ and $y$. 
\begin{itemize} 
\item The function $f$ has a {\bf local maximum} at a point $(x_0,y_0)$ provided that $f(x,y) \leq f(x_0,y_0)$ for all points $(x,y)$ near $(x_0,y_0)$.  In this situation we say that $f(x_0, y_0)$ is a {\bf local maximum
            value}.  
\item The function $f$ has a {\bf local minimum} at a point $(x_0,y_0)$ provided that $f(x,y) \geq f(x_0,y_0)$ for all points $(x,y)$ near $(x_0,y_0)$. In this situation we say that $f(x_0, y_0)$ is a {\bf local minimum value}.  
\item An {\bf absolute maximum point} is a point $(x_0,y_0)$ for  which $f(x,y)\leq f(x_0,y_0)$ for all points $(x,y)$ in the
          domain of $f$. The value of $f$ at an absolute maximum point is the {\bf maximum value} of $f$.
\item An {\bf absolute minimum point} is a point such that $f(x,y) \geq f(x_0,y_0)$ for all points $(x,y)$ in the domain of $f$. The value of $f$ at an absolute minimum point is the {\bf maximum value} of $f$.
\end{itemize}
    \end{definition}
} \hspace*{3 pt}}
\vspace*{5pt}

We use the term {\bf extremum point} to refer to any point $(x_0,y_0)$ at which $f$ has a local maximum or minimum.  In addition, the function value
          $f(x_0,y_0)$ at an extremum is called an {\bf extremal value}.  Figure \ref{F:10.7.extrema} illustrates the graphs of two functions
that have an absolute maximum and minimum, respectively, at the origin
$(x_0,y_0) = (0,0)$.   

\begin{figure}[ht]
  \begin{center}
    \includegraphics{figures/zis4r2.eps}
    \hspace*{20pt}
    \includegraphics{figures/zisr2.eps}
  \end{center}
  \caption{An absolute maximum and an absolute minimum}
  \label{F:10.7.extrema}
\end{figure}
    
In single-variable calculus, we saw that the extrema of a continuous function $f$ always occur at {\em critical points}, values of $x$ where $f$ fails to be differentiable or where $f'(x) = 0$.  Said differently, critical points provide the locations where extrema of a function may appear.  Our work in Preview Activity \ref{PA:10.7} suggests that something similar happens with two-variable functions.

Suppose that a continuous function $f$ has an extremum at $(x_0,y_0)$.  In this
case, the trace $f(x,y_0)$ has an extremum at $x_0$, which means
that $x_0$ is a critical value for the function $f(x,y_0)$.  Therefore,
either $f_x(x_0,y_0)$ does not exist or $f_x(x_0,y_0) = 0$.
Similarly, either $f_y(x_0,y_0)$ does not exist or $f_y(x_0,y_0) =
0$.  This implies that the extrema of a two-variable function occur at points that satisfy the following definition.

\vspace*{5pt}
\nin \framebox{\hspace*{3 pt}
\parbox{6.25 in}{
  \begin{definition} A \textbf{critical point}\index{critical point}
    $(x_0,y_0)$ of a function $f=f(x,y)$ is a point in the domain of $f$
    at which $f_x(x_0,y_0) = 0 $ and
    $f_y(x_0,y_0) = 0$, or such that one of
    $f_x(x_0,y_0)$ or $f_y(x_0,y_0)$ 
    fails to exist. \end{definition} 
} \hspace*{3 pt}}
\vspace*{5pt}

We can therefore find critical points of a function $f$ by computing partial derivatives and identifying any values of $(x,y)$ for which one of the partials doesn't exist or for which both partial derivatives are simultaneously zero.  For the latter, note that we have to solve the system of equations
\begin{align*}
f_x(x,y) &= 0 \\
f_y(x,y) & = 0.
\end{align*}

\input{activities/10.7.Act3}

\subsection*{Classifying Critical Points: The Second Derivative Test}

While the extrema of a continuous function $f$ always occur at critical points,
 it is important to note that not every critical point leads to
an extremum.  Recall, for instance, $f(x) = x^3$ from single variable calculus. We know that $x_0=0$ is a critical point since $f'(x_0) = 0$, but $x_0 = 0$ is neither a local maximum nor a local minimum of $f$.  

A similar situation may arise in a multivariable setting.   Consider the function $f$ defined by $f(x,y) = x^2 - y^2$ whose graph and contour
plot are shown in Figure \ref{F:10.7.saddle}.  Because $\nabla f =
\langle 2x, -2y\rangle$, we see that the origin $(x_0,y_0)=(0,0)$ is a
critical point.  However, this critical point is neither a local
maximum or minimum; the origin
is a local minimum on the trace defined by $y=0$, while the origin is a local maximum on the trace
defined by $x=0$.  We call such a critical point a {\bf saddle point}
due to the shape of the graph near the critical point.

\begin{figure}[ht]
  \begin{center}
    \includegraphics{figures/saddle.eps}
    \hspace*{20pt}
    \includegraphics{figures/saddle_contours.eps}
  \end{center}
  \caption{A saddle point.}
  \label{F:10.7.saddle}
\end{figure}

As in single-variable calculus, we would like to have some sort of test to help us identify whether a critical point is a local maximum, local maximum, or neither.  Before describing the test that accomplishes this classification in a two-variable setting, we recall the Second Derivative Test
from single-variable calculus.

\vspace*{5pt}
\nin \framebox{\hspace*{3 pt}
\parbox{6.25 in}{
 \textbf{The Second Derivative Test} for single-variable
functions.  If $x_0$ is a critical
point of a function $f$ so that $f'(x_0)=0$ and if $f''(x_0)$ exists, then 
\begin{itemize}
\item if $f''(x_0) < 0$, $x_0$ is a local maximum,
\item if $f''(x_0) > 0$, $x_0$ is a local minimum, and
\item if $f''(x_0) = 0$,  this test yields no information.
\end{itemize}
} \hspace*{3 pt}}
\vspace*{5pt}

For the analogous test for functions of two variables, we have to consider all of the second-order partial derivatives.
  
\vspace*{5pt}
\nin \framebox{\hspace*{3 pt}
  \parbox{6.25 in}{ \textbf{The Second Derivative Test} for
    two-variable functions. Suppose $(x_0,y_0)$ is a critical point of
    the function $f$ for which $f_x(x_0,y_0) = 0$ and
    $f_y(x_0,y_0) = 0$.  Let $D$ be the quantity defined by
  \[D = f_{xx}(x_0,y_0) f_{yy}(x_0,y_0) - f_{xy}(x_0,y_0)^2.\]
  \begin{itemize}
  \item If $D>0$ and $f_{xx}(x_0,y_0) < 0$, then $f$ has a relative maximum at $(x_0,y_0)$.
  \item If $D>0$ and $f_{xx}(x_0,y_0) > 0$, then $f$ has a local minimum at $(x_0,y_0)$.

  \item If $D < 0$, then $f$ has a saddle point at $(x_0,y_0)$.
  \item If $D = 0$, then this test yields no information about what happens at $(x_0,y_0)$.
  \end{itemize}

  The quantity $D$ is called the 
  \emph{discriminant}\index{discriminant} of the function $f$ at
  $(x_0,y_0)$.  

} \hspace*{3 pt}}
\vspace*{5pt}

To properly understand the origin of the Second Derivative Test, we
could introduce a ``second-order directional derivative.''  If this
second-order directional derivative were negative in every direction, for
instance, we could guarantee that the critical point is a local
maximum.  A complete justification of the Second Derivative Test requires key ideas from linear algebra that are beyond the scope of this course, so instead of presenting a detailed
explanation, we will accept this test as stated and demonstrate its use in three basic examples. 

\begin{figure}[ht]
  \begin{minipage}{3.75in}
    \begin{example} Let $f(x,y) = 4-x^2-y^2$ as
      shown in Figure \ref{F:10.7.max}.  Critical points occur when $f_x
      = -2x = 0$ and $f_y=-2y = 0$ so the origin $(x_0, y_0)= (0,0)$ is
      the only critical point.  We then find that
      $$
      f_{xx}(0,0) = -2, f_{yy}(0,0) = -2,\ \mbox{and} \ f_{xy}(0,0) = 0,
      $$
      giving $D = (-2)(-2) - 0^2 = 4 > 0$.  We then consider
      $f_{xx}(0,0) = -2 < 0$ and conclude, from the Second Derivative
      Test, that $f(0,0)=4$ is a local maximum value.
    \end{example}
  \end{minipage}
  \hspace*{0.25in}
  \begin{minipage}[h]{2.5in}
    \begin{center}
      \scalebox{0.8}{\includegraphics{figures/zis4r2.eps}}
      \caption{$z=4-x^2-y^2$}
      \label{F:10.7.max}
    \end{center}
  \end{minipage}
%\end{figure}

%\begin{figure}[ht]
  \begin{minipage}{3.75in}
    \begin{example} Let $f(x,y) = x^2+y^2$ as
      shown in Figure \ref{F:10.7.min}.  Critical points occur when $f_x
      = 2x = 0$ and $f_y=2y = 0$ so the origin $(x_0, y_0)= (0,0)$ is
      the only critical point.  We then find that
      $$
      f_{xx}(0,0) = 2, f_{yy}(0,0) = 2,\ \mbox{and} \ f_{xy}(0,0) = 0,
      $$
      giving $D = 2\cdot2 - 0^2 = 4 > 0$.  We then consider
      $f_{xx}(0,0) = 2 > 0$ and conclude, from the Second Derivative
      Test, that $f(0,0) = 0$ is a local minimum value.
    \end{example}
  \end{minipage}
  \hspace*{0.25in}
  \begin{minipage}[h]{2.5in}
    \begin{center}
      \scalebox{0.8}{\includegraphics{figures/zisr2.eps}}
      \caption{$z=x^2+y^2$}
      \label{F:10.7.min}
    \end{center}
  \end{minipage}
%\end{figure}

%\begin{figure}[ht]
  \begin{minipage}{3.75in}
    \begin{example} 
      Let $f(x,y) = x^2-y^2$ as
      shown in Figure \ref{F:10.7.saddle_2}.  Critical points occur when $f_x
      = 2x = 0$ and $f_y=-2y = 0$ so the origin $(x_0, y_0)= (0,0)$ is
      the only critical point.  We then find that
      $$
      f_{xx}(0,0) = 2, f_{yy}(0,0) = -2,\ \mbox{and} \ f_{xy}(0,0) = 0,
      $$
      giving $D = 2\cdot(-2) - 0^2 = -4 < 0$.  We then 
      conclude, from the Second Derivative
      Test, that $(0,0)$ is a saddle point.
    \end{example}
  \end{minipage}
  \hspace*{0.25in}
  \begin{minipage}[h]{2.5in}
    \begin{center}
      \scalebox{0.8}{\includegraphics{figures/saddle.eps}}
      \caption{$z=x^2-y^2$}
      \label{F:10.7.saddle_2}
    \end{center}
  \end{minipage}
\end{figure}
  
\newpage

\input{activities/10.7.Act5}

As we learned in single-variable calculus, finding extremal values of functions can be particularly useful in applied settings.  For instance, we can often use calculus to determine the least expensive
way to construct something or to find the most efficient route between two
locations.  The same possibility holds in settings with two or more variables.

\input{activities/10.7.Act10}




\subsection*{Optimization on a Restricted Domain}

The Second Derivative Test helps us classify critical points of a
function, but it does not tell us if the function actually has an
absolute maximum or minimum at each such point. For single-variable functions, the
Extreme Value Theorem told us that a continuous function on a
closed interval $[a, b]$ always has both an absolute maximum and minimum on
that interval, and that these absolute extremes must occur at either an endpoint or at a critical point. Thus, to find the absolute maximum and minimum, we determine the
critical points in the interval and then evaluate the function at these
critical point s and at the endpoints of the interval.  A similar approach works for functions of two variables.

For functions of two variables, closed and bounded regions play the
role that closed intervals did for functions of a single variable. A
closed region is a region that contains its boundary (the unit disk $x^2+y^2 \leq 1$ is closed, while its interior $x^2+y^2 < 1$ is not, for example), while a bounded region is
one that does not stretch to infinity in any direction. Just as for
functions of a single variable, continuous functions of several
variables that are defined on closed, bounded regions must have
absolute maxima and minima in those regions. 

\vspace*{5pt}
\nin \framebox{\hspace*{3 pt}
\parbox{6.25 in}{\textbf{The Extreme Value Theorem.} Let $f= f(x,y)$
  be a continuous function on a closed and bounded region $R$. Then
  $f$ has an absolute maximum and an absolute minimum in $R$. 
} \hspace*{3 pt}}
\vspace*{5pt}

The absolute extremes must occur at either a critical point in the interior of
$R$ or at a boundary point of $R$.  We
therefore must  test both possibilities, as we demonstrate in the following example.

\begin{example} Suppose the temperature $T$ at each point on the
  circular plate $x^2+y^2 \leq 1$ is given by
  \[T(x,y) = 2x^2+y^2-y.\] The domain $R=\{(x,y):x^2+y^2 \leq 1\}$ is
  a closed and bounded region, as shown on the left of Figure
  \ref{F:10.7.temperature}, so the Extreme Value Theorem assures us
  that $T$ has an absolute maximum and minimum on the plate.  The
  graph of $T$ over its domain $R$ is shown in Figure
  \ref{F:10.7.temperature}.  We will find the hottest and coldest
  points on the plate.  

  \begin{figure}[ht]
    \begin{center}
      \includegraphics{figures/fig_10_7_temperature_domain.eps}
      \hspace*{20pt}
      \scalebox{0.9}{\includegraphics{figures/fig_10_7_temperature.eps}}
    \end{center}
    \caption{Domain of the temperature $T(x,y) = 2x^2+y^2-y$ and its graph.}
    \label{F:10.7.temperature}
  \end{figure}

If the absolute maximum or minimum occurs inside the disk, it will be
at a critical point so we begin by looking for critical points inside
the disk.  To do this, notice that critical points are given by the
conditions $T_x= 4x=0$ and $T_y=2y - 1=0$.  This means that there is
one critical point of the function at the point $(x_0,y_0) =
(0,1/2)$, which lies inside the disk.

We now find the hottest and coldest points on the boundary of the
disk, which is the circle of radius 1.  As we have seen, the points on
the unit circle can be parametrized as
$$
x(t) = \cos t, \ y(t) = \sin t,
$$
where $0\leq t \leq 2\pi$.  The temperature at a point on the circle
is then described by
$$
T(x(t), y(t)) = 2\cos^2 t + \sin^2 t - \sin t.
$$

To find the hottest and coldest point on the boundary, we look for the
critical points of this single-variable function on the interval $0\leq t\leq 2\pi$.
We have
$$
\frac{dT}{dt} = -4\cos t\sin t + 2\cos t\sin t -\cos t = -2\cos t\sin
t - \cos t = \cos t (-2\sin t - 1) = 0.
$$
This shows that we have critical points when $\cos t = 0$ or $\sin t
= -1/2$.  This occurs when $t=\pi/2$, $3\pi/2$, $7\pi/6$, and
$11\pi/6$.  Since we have $x(t) = \cos t$ and $y(t) = \sin t$, the corresponding
points are 
\begin{center}
  \begin{tabular}{ll}
    $\bullet\ \ (x,y) = (0,1)$ when $t = \frac{\pi}{2}$, &
    $\bullet\ \ (x,y) = \left(-\frac{\sqrt{3}}{2},-\frac{1}{2}\right)$ when $t
    = \frac{7\pi}{6}$, \\
    $\bullet\ \ (x,y) = (0,-1)$ when $t = \frac{3\pi}{2}$,\hspace*{20pt} &
    $\bullet\ \ (x,y) = \left(\frac{\sqrt{3}}{2},-\frac{1}{2}\right)$ when $t =
    \frac{11\pi}{6}$. \hspace*{20pt}
    \end{tabular}
\end{center}
These are the critical points of $T$ on the boundary and so this
collection of points includes the hottest and coldest points on the
boundary. 

We now have a list of candidates for the hottest and coldest points:
the critical point in the interior of the disk and the critical points
on the boundary.  We find the hottest and coldest points by evaluating
the temperature at each of these points, and find that

\begin{center}
  \begin{tabular}{lll}
    $\bullet\ \  T\left(0,\frac{1}{2}\right) = -\frac{1}{4}$, \hspace*{20pt} &
    $\bullet\ \  T\left(0,1\right) = 0$, \hspace*{20pt} &
    $\bullet\ \  T\left(0,-1\right) = 2$, \\
    $\bullet\ \  T\left(-\frac{\sqrt{3}}{2},-\frac{1}{2}\right) =
    \frac{9}{4}$, \hspace*{20pt} &
    $\bullet\ \  T\left(\frac{\sqrt{3}}{2},-\frac{1}{2}\right) =
    \frac{9}{4}$. \hspace*{20pt} &
  \end{tabular}
\end{center}

So the maximum value of $T$ on the disk $x^2+y^2\leq 1$ is
$\frac{9}{4}$, which occurs at 
the two points $\left(\pm\frac{\sqrt{3}}{2},-\frac{1}{2}\right)$ on
the boundary, and the minimum value of $T$ on the disk is $-\frac{1}{4}$
which occurs at the critical point $\left(0,\frac{1}{2}\right)$ in the
interior of $R$.

\end{example}

From this example, we see that we use the following procedure for determining the absolute maximum and absolute minimum of a function on a closed and bounded domain.
\begin{description}
\item[Step 1:] Find all critical points of the function in the interior of the domain.
\item[Step 2:] Find all the critical points of the function on the boundary of the domain. Working on the boundary of the domain reduces this part of the problem to one or more single variable optimization problems.
\item[Step 3:] Evaluate the function at each of the points found in Steps 1 and 2.
\item[Step 4:] The maximum value of the function is the largest value obtained in Step 3, and the minimum value of the function is the smallest value obtained in Step 3.
\end{description}

\input{activities/10.7.Act6}

\newpage

\begin{summary}

\item To find the extrema of a function $f(x,y)$, we first find the
  critical points, which are points where one of the partials of $f$
  fails to exist, or where $f_x = 0$ and $f_y=0$.
\item The Second Derivative Test helps determine whether a critical
  point is a local maximum, local minimum, or saddle point.
\item If $f(x,y)$ is defined on a closed and bounded domain, we find
  the absolute maxima and minima by finding the critical points in the
  interior of the domain, finding the critical points on the boundary,
  and testing the value of $f$ at both sets of critical points.

\end{summary}


\nin \hrulefill

\input{exercises/10.7.Optimization(Ex)}

\clearpage
